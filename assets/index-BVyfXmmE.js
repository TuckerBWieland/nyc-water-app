import{r as e,o as t,a,c as s,b as r,d as o,e as l,w as n,f as i,g as d,n as c,u,t as p,h as g,i as m,j as f,k as y,l as v,m as h,F as x,p as b,q as k,s as w,v as M,x as D,y as N,z as P,A as S,B as C,C as _}from"./vue-CJQ7lJWc.js";import{r as $,g as A}from"./leaflet-DtqLV9Sc.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const j=e(!1);function L(){j.value=window.innerWidth<768}const O={__name:"App",setup:e=>(t(()=>{L(),window.addEventListener("resize",L)}),a(()=>{window.removeEventListener("resize",L)}),(e,t)=>{const a=r("router-view");return o(),s(a)})},T={};let E;const B="click_outbound_link";let R=!1;async function V(){try{const e="phc_w0axXDyN3zCal0qUUsV83NnyCoKsI9AKHXR59aat3tP";if(R)return;const t=await function(e,t){let a=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),r=(null==s?void 0:s.nonce)||(null==s?void 0:s.getAttribute("nonce"));a=e(t.map(e=>{if((e=function(e){return"/nyc-water-app/"+e}(e))in T)return;T[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":"modulepreload",t||(s.as="script"),s.crossOrigin="",s.href=e,r&&s.setAttribute("nonce",r),document.head.appendChild(s),t?new Promise((t,a)=>{s.addEventListener("load",t),s.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})}(()=>import("./analytics-BlUJbZ5Q.js"),[]);E=t.default||t;const a="https://app.posthog.com";E.init(e,{api_host:a,autocapture:!0,debug:!1}),R=!0}catch(e){}}function q(e,t={}){try{if(!R||!E)return;E.capture(e,t)}catch(a){}}const F="/nyc-water-app",I="2025-10-02";const W=e(!0);"undefined"!=typeof document&&(document.documentElement.classList.toggle("dark",W.value),document.body.classList.toggle("dark",W.value)),n(W,e=>{"undefined"!=typeof document&&(document.documentElement.classList.toggle("dark",e),document.body.classList.toggle("dark",e))});const z=()=>{W.value=!W.value},U=i({__name:"ThemeToggleButton",props:{isDarkMode:{type:Boolean,default:!1},sticky:{type:Boolean,default:!0}},setup:e=>(e,t)=>(o(),d("button",{onClick:t[0]||(t[0]=(...e)=>u(z)&&u(z)(...e)),class:c(["w-10 h-10 rounded-full shadow-md flex items-center justify-center transition-colors duration-300",[e.sticky?"fixed top-4 right-4 z-50":"",e.isDarkMode?"bg-gray-800 text-white":"bg-white text-gray-800"]])},p(e.isDarkMode?"☀️":"🌙"),3))}),H={class:"flex-1 flex flex-col"},Q={class:"px-6 py-8 relative"},Y={class:"absolute top-4 right-4"},G={class:"flex-1 flex flex-col items-center justify-center px-6 py-12"},K={class:"max-w-4xl mx-auto text-center space-y-12"},J={class:"space-y-6"},Z={key:0,class:"animate-pulse"},X={key:1,class:"text-red-500"},ee={class:"text-xl"},te={key:2,class:"space-y-8"},ae={class:"text-5xl md:text-7xl lg:text-8xl font-bold leading-tight tracking-tight"},se={class:"block text-blue-600 dark:text-blue-400"},re={class:"text-3xl md:text-4xl lg:text-5xl font-semibold text-red-600 dark:text-red-400"},oe={class:"max-w-2xl mx-auto space-y-6"},le={class:"px-6 py-8 text-center"},ne={class:"flex flex-col items-center space-y-6"},ie={class:"flex gap-6 text-sm"},de=(e,t)=>{const a=e.__vccOpts||e;for(const[s,r]of t)a[s]=r;return a},ce=de(i({__name:"welcome",setup(a){const s=g(),{stats:n,loadYearlyStats:i}=function(){const t=e(!0),a=e(null),s=e([]);return{stats:l(()=>0===s.value.length?{totalSamples:0,unsafeSamples:0,safeSamples:0,loading:t.value,error:a.value}:{totalSamples:s.value.reduce((e,t)=>e+t.totalSites,0),unsafeSamples:s.value.reduce((e,t)=>e+t.cautionSites+t.poorSites,0),safeSamples:s.value.reduce((e,t)=>e+t.goodSites,0),loading:t.value,error:a.value}),loadYearlyStats:async()=>{try{t.value=!0,a.value=null;const e=await fetch("/nyc-water-app/data/dates.json");if(!e.ok)throw new Error("Failed to load dates");const r=(await e.json()).map(async e=>{try{const t=`staticData-${e}`,a="undefined"!=typeof sessionStorage&&sessionStorage.getItem(t);let s,r=0;if(a)s=JSON.parse(a).geojson;else{const t=await fetch(`/nyc-water-app/data/${e}/enriched.geojson`);if(!t.ok)return null;s=await t.json()}let o=0,l=0,n=0;return s.features.forEach(e=>{const t=e.properties.mpn;null!=t&&(r++,t<=35?o++:t<=104?l++:n++)}),{date:e,totalSites:r,goodSites:o,cautionSites:l,poorSites:n,lastUpdated:e}}catch(t){return null}}),o=await Promise.all(r);s.value=o.filter(e=>null!==e)}catch(e){a.value=e instanceof Error?e.message:"Failed to load yearly stats"}finally{t.value=!1}}}}();t(()=>{i()});const h=()=>{s.push(`/${I}`)};return(e,t)=>{const a=r("router-link");return o(),d("div",{class:c(["min-h-screen flex flex-col",u(W)?"bg-gray-900 text-white":"bg-white text-gray-900"])},[m("div",H,[m("header",Q,[m("div",Y,[f(U,{isDarkMode:u(W),sticky:!1},null,8,["isDarkMode"])]),t[0]||(t[0]=m("h1",{class:"text-2xl md:text-2xl font-bold mb-4 tracking-tight text-left"}," NYC Water Quality ",-1))]),m("main",G,[m("div",K,[m("div",J,[u(n).loading?(o(),d("div",Z,t[1]||(t[1]=[m("div",{class:"h-16 md:h-24 bg-gray-300 dark:bg-gray-700 rounded mb-4"},null,-1),m("div",{class:"h-16 md:h-24 bg-gray-300 dark:bg-gray-700 rounded"},null,-1)]))):u(n).error?(o(),d("div",X,[m("p",ee,"Failed to load data: "+p(u(n).error),1)])):(o(),d("div",te,[m("h2",ae,[t[2]||(t[2]=m("span",{class:"block"},"WE'VE COLLECTED",-1)),m("span",se,p(u(n).totalSamples.toLocaleString()),1),t[3]||(t[3]=m("span",{class:"block"},"SAMPLES",-1)),t[4]||(t[4]=m("span",{class:"block"},"THIS YEAR",-1))]),m("p",re,p(u(n).unsafeSamples.toLocaleString())+" have tested unsafe for human contact ",1)]))]),m("div",oe,[m("p",{class:c(["text-lg md:text-xl leading-relaxed",u(W)?"text-gray-300":"text-gray-700"])}," This app visualizes water quality data from New York City's waterways, showing bacterial contamination levels at sampling sites across the five boroughs. The data helps residents understand which areas may be unsafe for activities like swimming, kayaking, or fishing. ",2),m("p",{class:c(["text-base md:text-lg leading-relaxed",u(W)?"text-gray-400":"text-gray-600"])}," Samples are categorized as safe (green), caution (yellow), or unsafe (red) based on bacterial levels. Higher bacterial counts typically occur after rainfall when stormwater runoff carries pollutants into waterways. ",2)])])]),m("footer",le,[m("div",ne,[m("button",{onClick:h,class:c(["inline-flex items-center px-8 py-4 text-xl font-semibold rounded-lg transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-500/50 shadow-lg hover:shadow-xl",(u(W),"bg-blue-600 hover:bg-blue-700 text-white")])},t[5]||(t[5]=[m("svg",{class:"w-6 h-6 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 4m0 13V4m0 0L9 7"})],-1),y(" View Latest Map Data ")]),2),m("div",ie,[f(a,{to:"/trends",class:c(["transition-colors hover:underline",u(W)?"text-gray-400 hover:text-gray-200":"text-gray-600 hover:text-gray-900"])},{default:v(()=>t[6]||(t[6]=[y(" 📊 View Trends ")])),_:1,__:[6]},8,["class"]),f(a,{to:"/research",class:c(["transition-colors hover:underline",u(W)?"text-gray-400 hover:text-gray-200":"text-gray-600 hover:text-gray-900"])},{default:v(()=>t[7]||(t[7]=[y(" 🔬 Statistical Analysis ")])),_:1,__:[7]},8,["class"])]),m("p",{class:c(["text-sm",u(W)?"text-gray-400":"text-gray-600"])}," Last update: "+p((new Date).toLocaleDateString()),3)])])])],2)}}}),[["__scopeId","data-v-89c8d2b5"]]);const ue=A($()),pe=e(!1),ge=35,me=104,fe=24196,ye="#22c55e",ve="#facc15",he="#ef4444";function xe(e){const t=function(e){if(null===e)return ve;const t=Number(e);return Number.isNaN(t)?ve:t<ge?ye:t<=me?ve:he}(e);return ue.divIcon({html:`\n      <div style="width: 16px; height: 32px; color: ${t}">\n        <svg viewBox="0 0 32 64" xmlns="http://www.w3.org/2000/svg" width="16" height="32">\n          <rect x="8" y="2" width="16" height="6" rx="2" fill="#ccc" stroke="black" stroke-width="0.5"/>\n          <rect x="10" y="8" width="12" height="4" rx="2" fill="#eee" stroke="black" stroke-width="0.5"/>\n          <rect x="6" y="12" width="20" height="44" rx="6" fill="currentColor" stroke="white" stroke-width="1"/>\n          <ellipse cx="16" cy="58" rx="8" ry="2" fill="white" opacity="0.2"/>\n        </svg>\n      </div>\n    `,className:"water-bottle-icon",iconSize:[16,32],iconAnchor:[8,32],popupAnchor:[0,-34]})}function be(e,t){const a=["F","S","S","M","T","W","Th"],s=(e||[]).filter(e=>"number"==typeof e&&!Number.isNaN(e)),r=s.length?Math.max(...s):0;return`\n    <div class="flex items-end justify-between h-16 mb-1">\n      ${e.map((e,s)=>{const o=0===r||null===e?0:e/r*100,l=e&&e>0?Number(e).toFixed(1):"";return`\n            <div class="flex flex-col items-center group h-full justify-end">\n              <div class="text-xs opacity-70 mb-1 font-medium" style="${l?"":"visibility:hidden"}">${l}</div>\n              <div class="w-4 rounded-t transition-all duration-300 shadow-md border border-black/10 min-h-[1px] ${n=e,null==n?t?"bg-gray-500":"bg-gray-300":n<.5?t?"bg-green-600":"bg-green-500":n<3?t?"bg-yellow-500":"bg-yellow-400":t?"bg-red-600":"bg-red-500"}" style="height:${o}%"></div>\n              <span class="text-xs mt-1 font-medium">${a[s%7]}</span>\n            </div>`;var n}).join("")}\n    </div>`}function ke(e){const t=new Date(e),a=t.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"});return`Sampled on ${t.getMonth()+1}/${t.getDate()} at ${a}`}const we=i({__name:"MapViewer",props:{selectedDate:{},isDarkMode:{type:Boolean,default:!1},geojson:{default:null}},setup(s){const r=s,l=e(null),i=e(null),u=e([]),p=e(null),g=e(!1),f=()=>function({map:e,tileLayer:t,markers:a,isDarkMode:s}){if(!e.value)return;t.value&&e.value.removeLayer(t.value);const r=s?"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png":"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png";t.value=ue.tileLayer(r,{attribution:"",maxZoom:19,subdomains:"abcd"}).addTo(e.value),function({map:e,markers:t,isDarkMode:a}){e.value&&t.value.forEach(e=>{const t=e.getPopup();if(t){const s=t.getContent();e.closePopup().unbindPopup(),e.bindPopup(s||"",{className:a?"dark-mode-popup":""})}})}({map:e,markers:a,isDarkMode:s})}({map:i,tileLayer:p,markers:u,isDarkMode:r.isDarkMode}),y=e=>function({map:e,markers:t,hasAutoFitted:a,isDarkMode:s,data:r}){if(!e.value)return;const o=e.value.getCenter(),l=e.value.getZoom();for(const i of t.value)i.remove();if(t.value=[],r.features&&0!==r.features.length){for(const a of r.features)try{if(!a.geometry||!a.geometry.coordinates||a.geometry.coordinates.length<2)continue;if(!a.properties)continue;const r=a.properties.siteName||"",o=a.properties.mpn,l=a.properties.timestamp||"";if(void 0===o)continue;const[n,i]=a.geometry.coordinates;if(isNaN(i)||isNaN(n))continue;const d=xe(o);let c,u;d.options.popupAnchor=[0,-40];const p=Number(o);p<35?(c="text-green-500",u="Acceptable for swimming"):p<=104?(c="text-yellow-400",u="Unacceptable if levels persist"):(c="text-red-500",u="Unacceptable for swimming");const g=e=>String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),m=g(r),f=g(null===o?"N/A":o.toString()),y=Number(o)===fe;let v=`\n        <div class="site-popup">\n          <div class="font-semibold text-lg site-name">${m}</div>\n          <div class="mt-2 ${c} font-medium text-base">\n            ${f}${y?"*":""} MPN/100mL\n          </div>\n          <div class="mt-1 text-sm opacity-75">\n            ${u}\n          </div>\n      `;if(y&&(v+='<div class="text-xs opacity-75 mt-1">*Sample reached the instrument detection limit.</div>'),l&&(v+=`<div class="text-xs opacity-75 mt-1">${g(ke(l))}</div>`),(a.properties.tide||void 0!==a.properties.rainfall_mm_7day)&&(v+='<div class="text-xs font-medium mt-3 pt-2 border-t border-gray-200">Environmental Conditions:</div>'),a.properties.tide&&(v+=`<div class="text-xs opacity-75 mt-1"><span title="Tidal data is taken from nearest NOAA station and is only approximate">${g(a.properties.tide)}</span></div>`),void 0!==a.properties.rainfall_mm_7day&&null!==a.properties.rainfall_mm_7day){const e=a.properties.rainfall_mm_7day||0,t=g(Number((.0393701*e).toFixed(2)).toFixed(2));if(j.value){const e=a.properties.rainByDay||[];v+=`<div class="text-xs opacity-75 mt-1">Total rainfall (7-day): ${t} in</div>`,v+='<button class="rain-toggle text-xs underline mt-1">Rain details</button>',v+=`<div class="rain-details hidden mt-1">${be(e,s)}</div>`}else v+=`<div class="text-xs opacity-75 mt-1"><span title="Rainfall data for the 7 days prior to sample date">Rainfall: ${t} in (7-day)</span></div>`}if(void 0!==a.properties.goodCount&&void 0!==a.properties.cautionCount&&void 0!==a.properties.poorCount){const e=g(a.properties.goodCount),t=g(a.properties.cautionCount),s=g(a.properties.poorCount);v+='<div class="text-xs font-medium mt-3 pt-2 border-t border-gray-200">This season:</div>',v+=`<div class="text-xs opacity-75 mt-1">${e} good, ${t} caution, ${s} poor</div>`}v+="</div>";const h=ue.marker([i,n],{icon:d}).bindPopup(v,{className:s?"dark-mode-popup":""}).addTo(e.value);h.on("click",()=>{q("click_site_marker",{site_name:r})}),h.on("popupopen",e=>{pe.value=!0;const t=e.popup.getElement(),a=null==t?void 0:t.querySelector(".rain-toggle");a&&a.addEventListener("click",()=>{const e=null==t?void 0:t.querySelector(".rain-details");e&&e.classList.toggle("hidden")})}),h.on("popupclose",()=>{pe.value=!1}),t.value.push(h)}catch(n){}if(t.value.length>0)if(a.value)e.value.setView(o,l);else{const s=ue.featureGroup(t.value);e.value.fitBounds(s.getBounds(),{padding:[30,30]}),a.value=!0}}}({map:i,markers:u,hasAutoFitted:g,isDarkMode:r.isDarkMode,data:e});return n(()=>r.isDarkMode,()=>{i.value&&l.value&&f()}),n(()=>r.geojson,e=>{e&&i.value&&y(e)},{immediate:!0}),t(()=>{l.value&&(i.value=ue.map(l.value).setView([40.7128,-74.006],12),f(),i.value.removeControl(i.value.zoomControl),r.geojson&&y(r.geojson))}),a(()=>{i.value&&i.value.remove()}),(e,t)=>(o(),d("div",{class:c(["w-full h-full",e.isDarkMode?"bg-gray-800":"bg-white"])},[m("div",{ref_key:"mapContainer",ref:l,class:"absolute inset-0 z-0"},null,512)],2))}}),Me=["F","S","S","M","T","W","Th"],De={name:"RainDropLegend",props:{selectedDate:{type:String,required:!0},isDarkMode:{type:Boolean,default:!1},rainfallData:{type:Array,default:()=>[]}},setup(e){const t=l(()=>e.rainfallData&&e.rainfallData.length>0?e.rainfallData:[]),a=l(()=>t.value.reduce((e,t)=>e+(t||0),0)),s=l(()=>a.value.toFixed(2)),r=l(()=>t.value.length>0&&t.value.some(e=>null!=e&&e>=0));return{activeRainData:t,totalRainfall:a,totalRainfallValue:s,hasValidRainfallData:r,getBarColorClass:t=>null==t?e.isDarkMode?"bg-gray-500":"bg-gray-300":t<.5?e.isDarkMode?"bg-green-600":"bg-green-500":t<3?e.isDarkMode?"bg-yellow-500":"bg-yellow-400":e.isDarkMode?"bg-red-600":"bg-red-500",getDayLabel:e=>Me[e%7],getBarHeight:e=>{const a=t.value.filter(e=>"number"==typeof e&&!Number.isNaN(e)),s=a.length?Math.max(...a):0;return 0===s?10:0===e?5:Math.max(e/s*100,10)},isMobile:j,featurePopupOpen:pe}}},Ne={class:"flex items-end justify-between h-16 mb-1"},Pe={key:0,class:"text-xs opacity-70 mb-1 font-medium"},Se=["title"],Ce={class:"text-xs mt-1 font-medium"},_e={class:"font-bold"};const $e=de(De,[["render",function(e,t,a,s,r,l){return s.isMobile&&s.featurePopupOpen||!s.hasValidRainfallData?h("",!0):(o(),d("div",{key:0,class:c(["rain-drop-legend p-3 rounded shadow-md",a.isDarkMode?"bg-gray-800 text-gray-200":"bg-white text-gray-800"])},[t[2]||(t[2]=m("h3",{class:"text-xs font-medium mb-2"},"7-Day Rainfall",-1)),m("div",Ne,[(o(!0),d(x,null,b(s.activeRainData,(e,t)=>(o(),d("div",{key:t,class:"flex flex-col items-center group h-full justify-end"},[e>0?(o(),d("div",Pe,p(e.toFixed(1)),1)):h("",!0),m("div",{class:c(["w-4 md:w-5 rounded-t transition-all duration-300 shadow-md border border-black/10 min-h-[1px]",s.getBarColorClass(e)]),style:k({height:`${s.getBarHeight(e)}%`}),title:`${null!=e?Number(e).toFixed(2):"No data"} inches`},null,14,Se),m("span",Ce,p(s.getDayLabel(t)),1)]))),128))]),m("div",{class:c(["text-xs text-center mt-2 pt-2 border-t",a.isDarkMode?"border-gray-700":"border-gray-200"])},[t[0]||(t[0]=m("span",{class:"font-semibold"},"Total rainfall:",-1)),m("span",_e,p(s.totalRainfallValue),1),t[1]||(t[1]=m("span",null,"in",-1))],2)],2))}],["__scopeId","data-v-71a941d4"]]),Ae={name:"SampleBarLegend",props:{samples:{type:Array,required:!0},isDarkMode:{type:Boolean,default:!1}},setup(e){const t=l(()=>e.samples.filter(e=>Number(e.properties.mpn)<35).length),a=l(()=>e.samples.filter(e=>{const t=Number(e.properties.mpn);return t>=35&&t<=104}).length),s=l(()=>e.samples.filter(e=>Number(e.properties.mpn)>104).length),r=l(()=>e.samples.length),o=l(()=>r.value>0?t.value/r.value*100:0),n=l(()=>r.value>0?a.value/r.value*100:0),i=l(()=>r.value>0?s.value/r.value*100:0);return{greenCount:t,yellowCount:a,redCount:s,totalCount:r,greenPercentage:o,yellowPercentage:n,redPercentage:i,isMobile:j,featurePopupOpen:pe}}},je={class:"w-full h-4 rounded-full overflow-hidden flex"},Le=["title"],Oe=["title"],Te=["title"],Ee={class:"flex justify-between text-xs mt-1"},Be={class:"flex items-center"},Re={class:"flex items-center"},Ve={class:"flex items-center"},qe={class:"font-bold"};const Fe=de(Ae,[["render",function(e,t,a,s,r,l){return s.isMobile&&s.featurePopupOpen?h("",!0):(o(),d("div",{key:0,class:c(["sample-bar-legend p-2 rounded shadow-md",a.isDarkMode?"bg-gray-800 text-gray-200":"bg-white text-gray-800"])},[t[4]||(t[4]=m("h3",{class:"text-xs font-medium mb-1"},"Sample Quality",-1)),m("div",je,[s.greenCount>0?(o(),d("div",{key:0,class:"h-full bg-green-500 transition-all duration-500 ease-out",style:k({width:`${s.greenPercentage}%`}),title:`${s.greenCount} Good samples`},null,12,Le)):h("",!0),s.yellowCount>0?(o(),d("div",{key:1,class:"h-full bg-yellow-400 transition-all duration-500 ease-out",style:k({width:`${s.yellowPercentage}%`}),title:`${s.yellowCount} Moderate samples`},null,12,Oe)):h("",!0),s.redCount>0?(o(),d("div",{key:2,class:"h-full bg-red-500 transition-all duration-500 ease-out",style:k({width:`${s.redPercentage}%`}),title:`${s.redCount} Poor samples`},null,12,Te)):h("",!0)]),m("div",Ee,[m("div",Be,[t[0]||(t[0]=m("span",{class:"inline-block w-2 h-2 bg-green-500 rounded-full mr-1"},null,-1)),m("span",null,p(s.greenCount),1)]),m("div",Re,[t[1]||(t[1]=m("span",{class:"inline-block w-2 h-2 bg-yellow-400 rounded-full mr-1"},null,-1)),m("span",null,p(s.yellowCount),1)]),m("div",Ve,[t[2]||(t[2]=m("span",{class:"inline-block w-2 h-2 bg-red-500 rounded-full mr-1"},null,-1)),m("span",null,p(s.redCount),1)])]),m("div",{class:c(["text-xs text-center mt-2 pt-2 border-t",a.isDarkMode?"border-gray-700":"border-gray-200"])},[t[3]||(t[3]=m("span",{class:"font-semibold"},"Total sites:",-1)),m("span",qe,p(s.totalCount),1)],2)],2))}],["__scopeId","data-v-b3390d92"]]),Ie={name:"DateScroller",props:{dates:{type:Array,required:!0},modelValue:{type:String,required:!0},isDarkMode:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:t}){const a=g(),s=l(()=>e.dates.indexOf(e.modelValue)),r=l(()=>s.value>0),o=l(()=>s.value<e.dates.length-1),n=l(()=>{if(!e.modelValue)return"";try{const[t,a,s]=e.modelValue.split("-").map(Number);return new Date(Date.UTC(t,a-1,s)).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",timeZone:"UTC"})}catch(t){return e.modelValue}});return{currentIndex:s,hasPrevious:r,hasNext:o,formattedModelValue:n,selectPrevious:()=>{if(r.value){const r=e.dates[s.value-1];t("update:modelValue",r),a.push({path:`/${r}`})}},selectNext:()=>{if(o.value){const r=e.dates[s.value+1];t("update:modelValue",r),a.push({path:`/${r}`})}}}}},We={class:"fixed bottom-[calc(6rem+env(safe-area-inset-bottom,0px))] left-1/2 transform -translate-x-1/2 z-[320]"},ze={class:"px-2 text-center whitespace-nowrap"};const Ue=de(Ie,[["render",function(e,t,a,s,r,l){return o(),d("div",We,[m("div",{class:c(["inline-flex items-center rounded-full px-6 py-3 shadow-md transition-colors duration-300",a.isDarkMode?"bg-gray-800 bg-opacity-90":"bg-white bg-opacity-90"])},[m("button",{class:c(["w-10 h-10 flex items-center justify-center mr-3 focus:outline-none transition-colors duration-300 text-xl",a.isDarkMode?"text-gray-300 hover:text-white":"text-gray-700 hover:text-black",{"opacity-0 pointer-events-none":!s.hasPrevious}]),"aria-label":"Previous date",onClick:t[0]||(t[0]=e=>s.hasPrevious&&s.selectPrevious())}," ← ",2),m("div",ze,[m("span",{class:c(["font-semibold transition-colors duration-300 text-sm sm:text-lg",a.isDarkMode?"text-gray-200":"text-gray-800"])},p(s.formattedModelValue),3)]),m("button",{class:c(["w-10 h-10 flex items-center justify-center ml-3 focus:outline-none transition-colors duration-300 text-xl",a.isDarkMode?"text-gray-300 hover:text-white":"text-gray-700 hover:text-black",{"opacity-0 pointer-events-none":!s.hasNext}]),"aria-label":"Next date",onClick:t[1]||(t[1]=e=>s.hasNext&&s.selectNext())}," → ",2)],2)])}]]),He=e(null),Qe=l(()=>null!==He.value);function Ye(e,t,a){const{isOpen:s,togglePopup:r,closePopup:o}=function(e){const t=l({get:()=>He.value===e,set:t=>{t?He.value=e:He.value===e&&(He.value=null)}});return{isOpen:t,togglePopup:()=>{t.value=!t.value},closePopup:()=>{He.value===e&&(He.value=null)}}}(e);return{isOpen:s,togglePopup:(e=!0)=>{try{const o=!s.value;r(),o&&e&&(q("open_popup",{component:t}),a&&q(a))}catch(o){r()}},closePopup:o}}const Ge={class:"flex justify-between items-center mb-2"},Ke={class:"font-bold"},Je={__name:"PopupContainer",props:{isOpen:{type:Boolean,required:!0},isDarkMode:{type:Boolean,required:!0},title:{type:String,required:!0}},emits:["close"],setup(t,{emit:s}){const r=t,l=s,i=e(null),u=e=>{i.value&&!i.value.contains(e.target)&&l("close")};return n(()=>r.isOpen,e=>{e?document.addEventListener("click",u):document.removeEventListener("click",u)}),a(()=>{document.removeEventListener("click",u)}),(e,a)=>t.isOpen?(o(),d("div",{key:0,ref_key:"popupRef",ref:i,onClick:a[1]||(a[1]=M(()=>{},["stop"])),class:c(["fixed z-[400] bottom-[calc(4rem+env(safe-area-inset-bottom,0px))] left-1/2 transform -translate-x-1/2","p-4 sm:p-6 rounded-lg shadow-lg","max-h-[calc(100vh-6rem)] overflow-y-auto scrollbar-stable","w-full sm:w-[455px] max-w-[95vw]","transition-colors duration-300",t.isDarkMode?"bg-gray-800 text-white":"bg-white text-black"])},[m("div",Ge,[m("h3",Ke,p(t.title),1),m("button",{class:c(t.isDarkMode?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-700"),onClick:a[0]||(a[0]=t=>e.$emit("close"))}," × ",2)]),m("div",{class:c(["prose text-sm",t.isDarkMode?"text-gray-300":"text-gray-700"])},[w(e.$slots,"default")],2)],2)):h("",!0)}},Ze=["title"],Xe={class:"font-semibold text-lg pointer-events-none"},et={__name:"PopupButton",props:{isDarkMode:{type:Boolean,required:!0},icon:{type:String,required:!0},title:{type:String,required:!0},variant:{type:String,default:"default",validator:e=>["default","notification"].includes(e)},showNotification:{type:Boolean,default:!1}},emits:["click"],setup:e=>(t,a)=>(o(),d("button",{class:c(["rounded-full w-10 h-10 flex items-center justify-center shadow-lg transition-colors duration-300 pointer-events-auto touch-action-manipulation","notification"===e.variant&&e.showNotification?"bg-orange-700 text-white hover:bg-orange-800":e.isDarkMode?"bg-gray-800 text-gray-200 hover:bg-gray-700":"bg-white text-gray-800 hover:bg-gray-100"]),style:{pointerEvents:"auto",touchAction:"manipulation"},title:e.title,onClick:a[0]||(a[0]=M(e=>t.$emit("click"),["stop"])),onTouchstart:a[1]||(a[1]=M(e=>t.$emit("click"),["stop","prevent"]))},[m("span",Xe,p(e.icon),1)],42,Ze))};const tt=de({name:"InfoPopup",components:{PopupContainer:Je,PopupButton:et},props:{isDarkMode:{type:Boolean,default:!1}},setup(){const{isOpen:e,togglePopup:a}=Ye("info","InfoPopup");return t(()=>{try{localStorage.getItem("hasSeenInfoPopup")||(a(!1),localStorage.setItem("hasSeenInfoPopup","true"))}catch(e){}}),{isOpen:e,togglePopup:a}}},[["render",function(e,t,a,s,l,n){const i=r("PopupContainer"),c=r("PopupButton");return o(),d(x,null,[f(i,{isOpen:s.isOpen,isDarkMode:a.isDarkMode,title:"About This Map",onClose:t[0]||(t[0]=e=>s.isOpen=!1)},{default:v(()=>t[1]||(t[1]=[m("p",null," This interactive map displays weekly water quality data collected by community scientists through the NYC Water Quality Monitoring program. ",-1),m("br",null,null,-1),m("p",null," Each dot represents a sampling site across NYC's waterways, color-coded based on the presence of enterococcus bacteria—an indicator of water safety for recreational activities. ",-1),m("p",{class:"mt-2"},[m("span",{class:"text-green-500 font-medium"},"Green"),y(": < 35 MPN/100mL - Acceptable for swimming ")],-1),m("p",{class:"mt-1"},[m("span",{class:"text-yellow-400 font-medium"},"Yellow"),y(": 35-104 MPN/100mL - Unacceptable if levels persist ")],-1),m("p",{class:"mt-1"},[m("span",{class:"text-red-500 font-medium"},"Red"),y(": > 104 MPN/100mL - Unacceptable for swimming ")],-1),m("p",{class:"mt-4 font-semibold"},"What does MPN mean?",-1),m("p",null," MPN stands for Most Probable Number — it's a way of estimating the number of bacteria in a water sample. Higher MPN values suggest more contamination and a higher risk for swimmers. Levels above 104 MPN/100mL are typically considered unsafe for recreational water. ",-1)])),_:1,__:[1]},8,["isOpen","isDarkMode"]),f(c,{isDarkMode:a.isDarkMode,icon:"i",title:"Information",onClick:s.togglePopup},null,8,["isDarkMode","onClick"])],64)}]]),at={name:"DataInfoPopup",components:{PopupContainer:Je,PopupButton:et},props:{isDarkMode:{type:Boolean,default:!1},showNotification:{type:Boolean,default:!1}},setup(e){const{isOpen:t,togglePopup:a}=Ye("data-info","DataInfoPopup","click_data_info_button");return{isOpen:t,togglePopup:a,trackOutbound:e=>{try{q(B,{url:e})}catch(t){}},showNotification:D(e,"showNotification")}}},st={class:"mt-2"};const rt=de(at,[["render",function(e,t,a,s,l,n){const i=r("PopupContainer"),c=r("PopupButton");return o(),d(x,null,[f(i,{isOpen:s.isOpen,isDarkMode:a.isDarkMode,title:"About the Data",onClose:t[1]||(t[1]=e=>s.isOpen=!1)},{default:v(()=>[t[4]||(t[4]=m("p",{class:"font-semibold mb-2"},"Key Finding: Location Matters More Than Rain",-1)),t[5]||(t[5]=m("p",null,[y(" Statistical analysis reveals that "),m("strong",null,"where you swim matters 3x more than when"),y(" (after rain). Location explains 20.5% of water quality variance while rainfall only explains 6.9%. Some sites are chronically polluted due to poor water circulation, nearby outfalls, or wildlife, regardless of weather. ")],-1)),t[6]||(t[6]=m("p",{class:"mt-3 font-semibold mb-2"},"Why rain still impacts water quality:",-1)),t[7]||(t[7]=m("p",null," When it rains heavily, New York City's sewer system—which combines sewage and stormwater in the same pipes—can become overwhelmed. To prevent backups into homes and streets, this excess mixture is discharged directly into waterways like Newtown Creek and the East River through Combined Sewer Overflows (CSOs). These overflows carry untreated sewage, bacteria, and other pollutants into the water, reducing water quality at affected sites. ",-1)),t[8]||(t[8]=m("p",{class:"mt-2 font-semibold mb-2"},"Where our rainfall and tide data come from:",-1)),t[9]||(t[9]=m("p",null," Rainfall data is sourced from NOAA's National Weather Service, specifically from the Central Park weather station. This provides a consistent benchmark for citywide precipitation. ",-1)),t[10]||(t[10]=m("br",null,null,-1)),t[11]||(t[11]=m("p",null," Tide data comes from NOAA's tide predictions, using the Battery (NY) tidal station as a reference. Tidal stage helps us understand how water is moving through the estuary, which affects how pollutants disperse. ",-1)),m("p",st,[t[2]||(t[2]=y(" View the detailed dataset ")),m("a",{href:"https://docs.google.com/spreadsheets/d/12wNiul0QSymg3gO9OdwKkvAms-iHkz2i0hyxl6AP8eQ/edit?gid=0#gid=0",target:"_blank",rel:"noopener",onClick:t[0]||(t[0]=e=>s.trackOutbound("https://docs.google.com/spreadsheets/d/12wNiul0QSymg3gO9OdwKkvAms-iHkz2i0hyxl6AP8eQ/edit?gid=0#gid=0"))},"here"),t[3]||(t[3]=y(". "))])]),_:1,__:[4,5,6,7,8,9,10,11]},8,["isOpen","isDarkMode"]),f(c,{isDarkMode:a.isDarkMode,icon:"?",title:"Data information",variant:"notification",showNotification:s.showNotification,onClick:s.togglePopup},null,8,["isDarkMode","showNotification","onClick"])],64)}]]),ot={name:"DonatePopup",components:{PopupContainer:Je,PopupButton:et},props:{isDarkMode:{type:Boolean,default:!1}},setup(){const{isOpen:e,togglePopup:t}=Ye("donate","DonatePopup","click_donate_button");return{isOpen:e,togglePopup:t,trackOutbound:e=>{try{q(B,{url:e})}catch(t){}}}}},lt={class:"list-disc pl-5"};const nt=de(ot,[["render",function(e,t,a,s,l,n){const i=r("PopupContainer"),c=r("PopupButton");return o(),d(x,null,[f(i,{isOpen:s.isOpen,isDarkMode:a.isDarkMode,title:"Support the Project",onClose:t[1]||(t[1]=e=>s.isOpen=!1)},{default:v(()=>[t[2]||(t[2]=m("p",{class:"mb-2"},"Help expand water quality monitoring by donating or volunteering.",-1)),m("ul",lt,[m("li",null,[m("a",{href:"https://www.newtowncreekalliance.org/donate/",target:"_blank",rel:"noopener",onClick:t[0]||(t[0]=e=>s.trackOutbound("https://www.newtowncreekalliance.org/donate/"))},"Newtown Creek Alliance")])])]),_:1,__:[2]},8,["isOpen","isDarkMode"]),f(c,{isDarkMode:a.isDarkMode,icon:"$",title:"Donate",onClick:s.togglePopup},null,8,["isDarkMode","onClick"])],64)}]]),it=i({__name:"TrendsButton",props:{isDarkMode:{type:Boolean,default:!1}},setup(e){const t=g(),a=()=>{t.push("/trends")};return(e,t)=>(o(),d("button",{class:c(["rounded-full w-10 h-10 flex items-center justify-center shadow-lg transition-colors duration-300 pointer-events-auto touch-action-manipulation",e.isDarkMode?"bg-gray-800 text-gray-200 hover:bg-gray-700":"bg-white text-gray-800 hover:bg-gray-100"]),style:{pointerEvents:"auto",touchAction:"manipulation"},"aria-label":"Trends",onClick:a,onTouchstart:M(a,["stop","prevent"])},t[0]||(t[0]=[m("span",{class:"font-semibold text-lg pointer-events-none"},"📊",-1)]),34))}}),dt=i({__name:"ResearchButton",props:{isDarkMode:{type:Boolean,default:!1}},setup(e){const t=g(),a=()=>{t.push("/research")};return(e,t)=>(o(),d("button",{class:c(["rounded-full w-10 h-10 flex items-center justify-center shadow-lg transition-colors duration-300 pointer-events-auto touch-action-manipulation",e.isDarkMode?"bg-gray-800 text-gray-200 hover:bg-gray-700":"bg-white text-gray-800 hover:bg-gray-100"]),style:{pointerEvents:"auto",touchAction:"manipulation"},"aria-label":"Research",onClick:a,onTouchstart:M(a,["stop","prevent"])},t[0]||(t[0]=[m("span",{class:"font-semibold text-lg pointer-events-none"},"🔬",-1)]),34))}}),ct=i({__name:"HomeButton",props:{isDarkMode:{type:Boolean,default:!1}},setup(e){const t=g(),a=()=>{t.push("/")};return(e,t)=>(o(),d("button",{class:c(["rounded-full w-10 h-10 flex items-center justify-center shadow-lg transition-colors duration-300 pointer-events-auto touch-action-manipulation",e.isDarkMode?"bg-gray-800 text-gray-200 hover:bg-gray-700":"bg-white text-gray-800 hover:bg-gray-100"]),style:{pointerEvents:"auto",touchAction:"manipulation"},"aria-label":"Home",onClick:a,onTouchstart:M(a,["stop","prevent"])},t[0]||(t[0]=[m("span",{class:"font-semibold text-lg pointer-events-none"},"🏠",-1)]),34))}});function ut(t){const a=e(null),s=e(null),r=e(!1),o=e(null);return{data:a,metadata:s,loading:r,error:o,load:async function(e=u(t)){if(!e)return void(o.value="No date provided");o.value=null,r.value=!0;const l=`staticData-${e}`;try{const e="undefined"!=typeof sessionStorage&&sessionStorage.getItem(l);if(e){const t=JSON.parse(e);return a.value=t.geojson,s.value=t.metadata,void(r.value=!1)}}catch(n){}try{const t=`${F}/data/${e}/enriched.geojson`,r=`${F}/data/${e}/metadata.json`,[o,i]=await Promise.all([fetch(t),fetch(r)]);if(!o.ok)throw new Error(`Failed to fetch GeoJSON: ${o.status}`);if(!i.ok)throw new Error(`Failed to fetch metadata: ${i.status}`);const d=await o.json(),c=await i.json();a.value=d,s.value=c;try{"undefined"!=typeof sessionStorage&&sessionStorage.setItem(l,JSON.stringify({geojson:d,metadata:c}))}catch(n){}}catch(n){o.value=n instanceof Error?n.message:"An unknown error occurred",a.value=null,s.value=null}finally{r.value=!1}}}}const pt={key:0},gt={class:"absolute top-2 left-2 z-10 space-y-2"},mt={class:"fixed bottom-[calc(1rem+env(safe-area-inset-bottom,0px))] inset-x-0 flex flex-nowrap overflow-x-auto scrollbar-stable justify-center gap-4 px-4 z-[300]"},ft={key:0,class:"text-lg"},yt={key:1,class:"text-red-500"},vt={class:"text-lg"},ht={class:"mt-2"},xt={key:2,class:"text-lg"},bt={__name:"index",setup(a){const r=g(),i=e(I),y=e([]),{data:v,metadata:x,loading:b,error:k,load:w}=ut(i),M=l(()=>{if(!v.value||!Array.isArray(v.value.features))return 0;const e=v.value.features.length;if(0===e)return 0;return v.value.features.filter(e=>Number(e.properties.mpn)>104).length/e*100}),D=l(()=>M.value>50);return t(async()=>{try{const e=F,t=await fetch(`${e}/data/dates.json`);if(t.ok){const e=await t.json();y.value=Array.isArray(e)?e.sort():[]}}catch(e){}await w()}),n(i,e=>{e!==I&&r.replace(`/${e}`),w(e)}),(e,t)=>{var a;return o(),d("div",null,[f(U,{isDarkMode:u(W)},null,8,["isDarkMode"]),u(v)&&u(x)?(o(),d("div",pt,[u(Qe)?h("",!0):(o(),s(Ue,{key:0,dates:y.value,modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e),isDarkMode:u(W)},null,8,["dates","modelValue","isDarkMode"])),m("div",gt,[f(Fe,{samples:u(v).features,isDarkMode:u(W)},null,8,["samples","isDarkMode"]),f($e,{selectedDate:i.value,isDarkMode:u(W),rainfallData:(null==(a=u(v).features[0])?void 0:a.properties.rainByDay)||[]},null,8,["selectedDate","isDarkMode","rainfallData"])]),f(we,{selectedDate:i.value,isDarkMode:u(W),geojson:u(v)},null,8,["selectedDate","isDarkMode","geojson"]),m("div",mt,[f(ct,{isDarkMode:u(W)},null,8,["isDarkMode"]),f(tt,{isDarkMode:u(W)},null,8,["isDarkMode"]),f(rt,{isDarkMode:u(W),showNotification:D.value},null,8,["isDarkMode","showNotification"]),f(nt,{isDarkMode:u(W)},null,8,["isDarkMode"]),f(it,{isDarkMode:u(W)},null,8,["isDarkMode"]),f(dt,{isDarkMode:u(W)},null,8,["isDarkMode"])])])):(o(),d("div",{key:1,class:c(["text-center h-screen flex items-center justify-center flex-col",u(W)?"bg-gray-800 text-gray-100":"bg-white text-gray-900"])},[u(b)?(o(),d("div",ft,"Loading water quality data...")):u(k)?(o(),d("div",yt,[m("p",vt,"Error: "+p(u(k)),1),m("p",ht,"Could not load data for "+p(i.value),1)])):(o(),d("div",xt,"No data available"))],2))])}}},kt={key:0},wt={class:"absolute top-2 left-2 z-10 space-y-2"},Mt={class:"fixed bottom-[calc(1rem+env(safe-area-inset-bottom,0px))] inset-x-0 flex flex-nowrap overflow-x-auto scrollbar-stable justify-center gap-4 px-4 z-[300]"},Dt={key:0,class:"text-lg"},Nt={key:1,class:"text-red-500"},Pt={class:"text-lg"},St={class:"mt-2"},Ct={key:2,class:"text-lg"},_t={__name:"[date]",setup(a){const r=N();g();const i=e(r.params.date),y=e([]),{data:v,metadata:x,loading:b,error:k,load:w}=ut(i),M=l(()=>{if(!v.value||!Array.isArray(v.value.features))return 0;const e=v.value.features.length;if(0===e)return 0;return v.value.features.filter(e=>Number(e.properties.mpn)>104).length/e*100}),D=l(()=>M.value>50);return t(async()=>{try{const e=F,t=await fetch(`${e}/data/dates.json`);if(t.ok){const e=await t.json();y.value=Array.isArray(e)?e.sort():[]}}catch(e){}await w()}),n(()=>r.params.date,e=>{e&&(i.value=e,w(e))}),(e,t)=>{var a;return o(),d("div",null,[f(U,{isDarkMode:u(W)},null,8,["isDarkMode"]),u(v)&&u(x)?(o(),d("div",kt,[u(Qe)?h("",!0):(o(),s(Ue,{key:0,dates:y.value,modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e),isDarkMode:u(W)},null,8,["dates","modelValue","isDarkMode"])),m("div",wt,[f(Fe,{samples:u(v).features,isDarkMode:u(W)},null,8,["samples","isDarkMode"]),f($e,{selectedDate:i.value,isDarkMode:u(W),rainfallData:(null==(a=u(v).features[0])?void 0:a.properties.rainByDay)||[]},null,8,["selectedDate","isDarkMode","rainfallData"])]),f(we,{selectedDate:i.value,isDarkMode:u(W),geojson:u(v)},null,8,["selectedDate","isDarkMode","geojson"]),m("div",Mt,[f(ct,{isDarkMode:u(W)},null,8,["isDarkMode"]),f(tt,{isDarkMode:u(W)},null,8,["isDarkMode"]),f(rt,{isDarkMode:u(W),showNotification:D.value},null,8,["isDarkMode","showNotification"]),f(nt,{isDarkMode:u(W)},null,8,["isDarkMode"]),f(it,{isDarkMode:u(W)},null,8,["isDarkMode"]),f(dt,{isDarkMode:u(W)},null,8,["isDarkMode"])])])):(o(),d("div",{key:1,class:c(["text-center h-screen flex items-center justify-center flex-col",u(W)?"bg-gray-800 text-gray-100":"bg-white text-gray-900"])},[u(b)?(o(),d("div",Dt,"Loading water quality data...")):u(k)?(o(),d("div",Nt,[m("p",Pt,"Error: "+p(u(k)),1),m("p",St,"Could not load data for "+p(i.value),1)])):(o(),d("div",Ct,"No data available"))],2))])}}},$t={class:"heatmap-container"},At={class:"date-cell"},jt=["title"],Lt=["title"],Ot=de({__name:"RainfallSampleTrend",props:{history:{type:Array,required:!0},isDarkMode:{type:Boolean,default:!1}},setup(e){const t=e=>{if(e<=35){return`hsl(140, 70%, ${75-25*(e/35)}%)`}if(e<=104){const t=(e-35)/69;return`hsl(${140-110*t}, 80%, ${70-15*t}%)`}{const t=Math.min((e-104)/200,1);return`hsl(${30-25*t}, 85%, ${55-10*t}%)`}};return(a,s)=>(o(),d("div",$t,[m("div",{class:c(["correlation-info",{"dark-mode":e.isDarkMode}])},s[0]||(s[0]=[m("div",{class:"info-icon"},"📊",-1),m("div",{class:"info-content"},[m("strong",null,"Key Finding: Location Matters More Than Rain"),m("p",null,[y("Statistical analysis reveals that "),m("strong",null,"WHERE you swim matters 3x more than WHEN"),y(" (after rain). Location explains 20.5% of water quality variance while rainfall only explains 6.9%. Some sites are chronically polluted due to poor water circulation, nearby outfalls, or wildlife, regardless of weather.")])],-1)]),2),s[1]||(s[1]=m("div",{class:"heatmap-grid"},[m("div",{class:"header-cell"},"Date"),m("div",{class:"header-cell"},"Rain (1-2 days prior)"),m("div",{class:"header-cell"},"Avg Water Quality (MPN)")],-1)),(o(!0),d(x,null,b(e.history,e=>{return o(),d("div",{key:e.date,class:"heatmap-grid data-row"},[m("div",At,p((s=e.date,new Date(s+"T00:00:00Z").toLocaleDateString("en-US",{month:"short",day:"numeric"}))),1),m("div",{class:"value-cell rainfall-cell",style:k({backgroundColor:(a=e.recent2DayRainfall,`hsl(210, 100%, ${85-50*Math.min(a/2,1)}%)`)}),title:`${e.recent2DayRainfall.toFixed(2)} inches in 1-2 days before sampling`},p(e.recent2DayRainfall.toFixed(2))+"″ ",13,jt),m("div",{class:"value-cell mpn-cell",style:k({backgroundColor:t(e.avgMpn)}),title:`Average MPN: ${Math.round(e.avgMpn)}`},p(Math.round(e.avgMpn)),13,Lt)]);var a,s}),128)),s[2]||(s[2]=P('<div class="legend" data-v-d03a3d01><div class="legend-section" data-v-d03a3d01><div class="legend-title" data-v-d03a3d01>Rainfall 1-2 days before sampling (inches)</div><div class="legend-gradient" data-v-d03a3d01><div class="gradient-bar rainfall-gradient" data-v-d03a3d01></div><div class="gradient-labels" data-v-d03a3d01><span data-v-d03a3d01>0</span><span data-v-d03a3d01>2.0+</span></div></div></div><div class="legend-section" data-v-d03a3d01><div class="legend-title" data-v-d03a3d01>Average Water Quality (MPN bacteria count)</div><div class="legend-gradient" data-v-d03a3d01><div class="gradient-bar mpn-gradient" data-v-d03a3d01></div><div class="gradient-labels" data-v-d03a3d01><span data-v-d03a3d01>Good (0-35)</span><span data-v-d03a3d01>Unsafe (200+)</span></div></div></div></div>',1))]))}},[["__scopeId","data-v-d03a3d01"]]),Tt=i({__name:"MapButton",props:{isDarkMode:{type:Boolean,default:!1}},setup(e){const t=g(),a=()=>{t.push(`/${I}`)};return(e,t)=>(o(),d("button",{class:c(["rounded-full w-10 h-10 flex items-center justify-center shadow-lg transition-colors duration-300 pointer-events-auto touch-action-manipulation",e.isDarkMode?"bg-gray-800 text-gray-200 hover:bg-gray-700":"bg-white text-gray-800 hover:bg-gray-100"]),style:{pointerEvents:"auto",touchAction:"manipulation"},"aria-label":"Map",onClick:a,onTouchstart:M(a,["stop","prevent"])},t[0]||(t[0]=[m("span",{class:"font-semibold text-lg pointer-events-none"},"🗺️",-1)]),34))}}),Et={class:"min-h-screen bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-200"},Bt={class:"max-w-screen-lg mx-auto px-4 pt-14 pb-24 text-center"},Rt={key:0,class:"text-center py-10"},Vt={key:1,class:"overflow-x-auto"},qt={class:"mt-6 text-center"},Ft={key:2,class:"mt-8 max-w-screen-lg mx-auto"},It={class:"grid md:grid-cols-2 gap-6"},Wt={class:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4 border border-red-200 dark:border-red-800"},zt={class:"space-y-2 text-sm"},Ut={class:"font-medium text-gray-900 dark:text-gray-100"},Ht={class:"text-xs text-gray-600 dark:text-gray-400"},Qt={key:0,class:"ml-1 text-red-600 dark:text-red-400"},Yt={class:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800"},Gt={class:"space-y-2 text-sm"},Kt={class:"font-medium text-gray-900 dark:text-gray-100"},Jt={class:"text-xs text-gray-600 dark:text-gray-400"},Zt={key:0,class:"ml-1 text-green-600 dark:text-green-400"},Xt={class:"fixed bottom-[calc(1rem+env(safe-area-inset-bottom,0px))] left-1/2 transform -translate-x-1/2 z-50 flex gap-4"},ea={__name:"trends",setup(a){const s=e([]),l=e(!0),n=e([]);return t(async()=>{try{const e=F,t=await fetch(`${e}/data/dates.json`),a=await t.json()||[],r=(await Promise.all(a.map(async t=>{var a;const s=await fetch(`${e}/data/${t}/enriched.geojson`);if(!s.ok)return null;const r=await s.json(),o={good:0,caution:0,unsafe:0};let l=0,n=0;for(const e of r.features){const t=Number(e.properties.mpn);isNaN(t)||(l+=t,n++),t<35?o.good++:t<=104?o.caution++:o.unsafe++}const i=(null==(a=r.features[0])?void 0:a.properties.rainByDay)||[],d=i.reduce((e,t)=>e+t,0),c=i.length>=2?i.slice(-2).reduce((e,t)=>e+t,0):d;return{date:t,rainfallByDay:i,sampleSummary:o,totalRainfall:d,recent2DayRainfall:c,avgMpn:n>0?l/n:0}}))).filter(Boolean);s.value=r.sort((e,t)=>e.date.localeCompare(t.date));const o=new Map;for(const s of r){const t=await fetch(`${e}/data/${s.date}/enriched.geojson`);if(!t.ok)continue;const a=await t.json();for(const e of a.features){const t=e.properties.siteName,a=Number(e.properties.mpn);t&&!isNaN(a)&&(o.has(t)||o.set(t,[]),o.get(t).push(a))}}const l=Array.from(o.entries()).map(([e,t])=>{const a=t.reduce((e,t)=>e+t,0)/t.length,s=[...t].sort((e,t)=>e-t),r=s[Math.floor(s.length/2)],o=t.filter(e=>e>104).length,l=t.filter(e=>e<=35).length;return{siteName:e,avgMpn:a,medianMpn:r,samples:t.length,consistentlyUnsafe:o/t.length>=.75,consistentlyGood:l/t.length>=.75}});l.sort((e,t)=>t.avgMpn-e.avgMpn),n.value=l}catch(e){}finally{l.value=!1}}),(e,t)=>{const a=r("router-link");return o(),d("div",Et,[m("div",Bt,[f(U,{isDarkMode:u(W)},null,8,["isDarkMode"]),t[5]||(t[5]=m("h1",{class:"text-2xl font-bold mb-6 text-gray-900 dark:text-white"}," Trends: Rainfall vs Water Quality ",-1)),l.value?(o(),d("div",Rt,"Loading…")):(o(),d("div",Vt,[f(Ot,{history:s.value,isDarkMode:u(W)},null,8,["history","isDarkMode"])])),t[6]||(t[6]=m("p",{class:"text-base text-gray-700 dark:text-gray-300 mt-6 max-w-prose mx-auto"},[y(" This heatmap shows how recent rainfall relates to citywide average water quality. While there's a moderate correlation, "),m("strong",null,"individual location matters much more"),y(". Some sites are consistently unsafe due to poor circulation, nearby outfalls, or wildlife—regardless of weather. ")],-1)),m("div",qt,[f(a,{to:"/research"},{default:v(()=>t[0]||(t[0]=[m("button",{class:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 dark:bg-blue-700 text-white rounded-lg shadow-lg hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors font-semibold"}," 🔬 View Detailed Statistical Analysis ",-1)])),_:1,__:[0]}),t[1]||(t[1]=m("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-2"}," Deep dive into correlation analysis, ANOVA, and research methods ",-1))]),n.value.length>0?(o(),d("div",Ft,[t[4]||(t[4]=m("h2",{class:"text-xl font-bold mb-4 text-gray-900 dark:text-white"},"📍 Best & Worst Locations",-1)),m("div",It,[m("div",Wt,[t[2]||(t[2]=m("h3",{class:"font-semibold text-red-900 dark:text-red-200 mb-3 flex items-center gap-2"},[m("span",null,"🚨"),y(" Avoid These Locations ")],-1)),m("div",zt,[(o(!0),d(x,null,b(n.value.slice(0,5),(e,t)=>(o(),d("div",{key:e.siteName,class:"text-left"},[m("div",Ut,p(t+1)+". "+p(e.siteName),1),m("div",Ht,[y(" Avg MPN: "+p(Math.round(e.avgMpn))+" ",1),e.consistentlyUnsafe?(o(),d("span",Qt,"(always unsafe)")):h("",!0)])]))),128))])]),m("div",Yt,[t[3]||(t[3]=m("h3",{class:"font-semibold text-green-900 dark:text-green-200 mb-3 flex items-center gap-2"},[m("span",null,"✅"),y(" Consistently Safe Locations ")],-1)),m("div",Gt,[(o(!0),d(x,null,b(n.value.slice(-5).reverse(),(e,t)=>(o(),d("div",{key:e.siteName,class:"text-left"},[m("div",Kt,p(t+1)+". "+p(e.siteName),1),m("div",Jt,[y(" Avg MPN: "+p(Math.round(e.avgMpn))+" ",1),e.consistentlyGood?(o(),d("span",Zt,"(always safe)")):h("",!0)])]))),128))])])])])):h("",!0),t[7]||(t[7]=m("div",{class:"text-sm text-gray-600 dark:text-gray-400 mt-6 max-w-prose mx-auto p-4 bg-blue-50 dark:bg-gray-800 rounded-lg border border-blue-200 dark:border-gray-700"},[m("strong",{class:"text-gray-900 dark:text-gray-100"},"💡 Takeaway:"),m("p",{class:"mt-2"},[y("Check your specific location on the map before swimming. Some spots like Hudson River piers are consistently safe, while others like Gowanus Canal or Newtown Creek are chronically polluted. Rain matters, but "),m("strong",null,"where you swim matters more"),y(".")])],-1)),m("div",Xt,[f(ct,{isDarkMode:u(W)},null,8,["isDarkMode"]),f(Tt,{isDarkMode:u(W)},null,8,["isDarkMode"]),f(dt,{isDarkMode:u(W)},null,8,["isDarkMode"])])])])}}},ta={class:"min-h-screen bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-200"},aa={class:"max-w-screen-lg mx-auto px-4 pt-14 pb-24"},sa={key:0,class:"text-center py-10"},ra={key:1,class:"space-y-8"},oa={class:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-6 border border-blue-200 dark:border-blue-800"},la={class:"grid md:grid-cols-2 gap-4"},na={class:"bg-white dark:bg-gray-800 rounded p-4 border border-blue-100 dark:border-gray-700"},ia={class:"text-3xl font-bold text-blue-600 dark:text-blue-400"},da={class:"bg-white dark:bg-gray-800 rounded p-4 border border-blue-100 dark:border-gray-700"},ca={class:"text-3xl font-bold text-blue-600 dark:text-blue-400"},ua={class:"mt-4 text-sm text-gray-700 dark:text-gray-300"},pa={class:"space-y-6"},ga={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-5 border border-gray-200 dark:border-gray-700"},ma={class:"grid md:grid-cols-3 gap-3"},fa={class:"bg-blue-100 dark:bg-blue-900/30 rounded p-3"},ya={class:"text-xl font-bold text-blue-700 dark:text-blue-300"},va={class:"bg-blue-100 dark:bg-blue-900/30 rounded p-3"},ha={class:"text-xl font-bold text-blue-700 dark:text-blue-300"},xa={class:"bg-blue-100 dark:bg-blue-900/30 rounded p-3"},ba={class:"text-xl font-bold text-blue-700 dark:text-blue-300"},ka={class:"text-sm text-gray-700 dark:text-gray-300 mt-3"},wa={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-5 border border-gray-200 dark:border-gray-700"},Ma={class:"grid md:grid-cols-3 gap-3"},Da={class:"bg-green-100 dark:bg-green-900/30 rounded p-3"},Na={class:"text-xl font-bold text-green-700 dark:text-green-300"},Pa={class:"bg-green-100 dark:bg-green-900/30 rounded p-3"},Sa={class:"text-xl font-bold text-green-700 dark:text-green-300"},Ca={class:"bg-green-100 dark:bg-green-900/30 rounded p-3"},_a={class:"text-xl font-bold text-green-700 dark:text-green-300"},$a={class:"text-sm text-gray-700 dark:text-gray-300 mt-3"},Aa={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-5 border border-gray-200 dark:border-gray-700"},ja={class:"overflow-x-auto"},La={class:"w-full text-xs"},Oa={class:"py-2 px-2 text-gray-700 dark:text-gray-300"},Ta={class:"text-right py-2 px-2 text-gray-700 dark:text-gray-300"},Ea={class:"text-right py-2 px-2 text-gray-700 dark:text-gray-300"},Ba={class:"py-2 px-4"},Ra={class:"flex items-center gap-1"},Va=["title"],qa=["title"],Fa={class:"grid md:grid-cols-2 gap-6"},Ia={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-5 border border-gray-200 dark:border-gray-700"},Wa={class:"space-y-2 text-sm"},za={class:"flex-1"},Ua={class:"font-medium text-gray-900 dark:text-gray-100"},Ha={class:"text-xs text-gray-600 dark:text-gray-400"},Qa={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-5 border border-gray-200 dark:border-gray-700"},Ya={class:"space-y-2 text-sm"},Ga={class:"flex-1"},Ka={class:"font-medium text-gray-900 dark:text-gray-100"},Ja={class:"text-xs text-gray-600 dark:text-gray-400"},Za={class:"bg-amber-50 dark:bg-amber-900/20 rounded-lg p-6 border border-amber-200 dark:border-amber-800"},Xa={class:"space-y-3 text-sm text-gray-700 dark:text-gray-300"},es={class:"flex gap-3"},ts={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700"},as={class:"space-y-2 text-sm text-gray-700 dark:text-gray-300 list-disc list-inside"},ss={class:"fixed bottom-[calc(1rem+env(safe-area-inset-bottom,0px))] left-1/2 transform -translate-x-1/2 z-50 flex gap-4"},rs=i({__name:"research",setup(a){const s=e(!0),r=e([]),n=e(null),i=e(0),c=e([]),g=e(0);function v(e){return e.reduce((e,t)=>e+t,0)/e.length}function h(e,t){return e.reduce((e,a)=>e+Math.pow(a-t,2),0)/e.length}t(async()=>{var e;try{const t=F,a=await fetch(`${t}/data/dates.json`),s=await a.json()||[],o=[];for(const r of s){const a=await fetch(`${t}/data/${r}/enriched.geojson`);if(!a.ok)continue;const s=await a.json();let l=0,n=0;const i=new Map;for(const e of s.features){const t=Number(e.properties.mpn),a=e.properties.siteName;!isNaN(t)&&a&&(l+=t,n++,i.has(a)||i.set(a,[]),i.get(a).push(t))}const d=(null==(e=s.features[0])?void 0:e.properties.rainByDay)||[],c=d.length>=2?d.slice(-2).reduce((e,t)=>e+t,0):0,u=n>0?l/n:0;o.push({date:r,avgMpn:u,recent2DayRainfall:c,locationMpns:i})}r.value=o;const l=[],d=[];for(const e of o)e.locationMpns.forEach(t=>{for(const a of t)l.push(e.recent2DayRainfall),d.push(a)});n.value=function(e,t){const a=e.length,s=v(e),r=v(t);let o=0,l=0,n=0;for(let u=0;u<a;u++){const a=e[u]-s,i=t[u]-r;o+=a*i,l+=a*a,n+=i*i}const i=o/Math.sqrt(l*n),d=i*i,c=i*Math.sqrt((a-2)/(1-d));return{r:i,rSquared:d,pValue:c>2.5?.01:c>2?.05:.1}}(l,d),i.value=function(e){const t=new Map;let a=[];for(const d of e)d.locationMpns.forEach((e,s)=>{t.has(s)||t.set(s,[]),t.get(s).push(...e),a.push(...e)});const s=v(a),r=h(a,s);let o=0,l=0;t.forEach(e=>{const t=v(e),a=e.length;o+=a*Math.pow(t-s,2),l+=a}),o/=l;const n=o/r*100,i=[];return t.forEach((e,t)=>{const a=v(e),s=h(e,a);i.push({siteName:t,avgMpn:a,variance:s,samples:e.length})}),c.value=i.sort((e,t)=>t.avgMpn-e.avgMpn),g.value=a.length,n}(o)}catch(t){}finally{s.value=!1}});const w=l(()=>r.value.length?r.value.map(e=>({x:e.recent2DayRainfall,y:e.avgMpn,date:e.date})):[]),M=l(()=>c.value.filter(e=>e.samples>=5).sort((e,t)=>t.variance-e.variance).slice(0,10)),D=l(()=>c.value.filter(e=>e.samples>=5).sort((e,t)=>e.variance-t.variance).slice(0,10));return(e,t)=>{var a,l,v,h,N,S,C;return o(),d("div",ta,[m("div",aa,[f(U,{isDarkMode:u(W)},null,8,["isDarkMode"]),t[42]||(t[42]=m("h1",{class:"text-3xl font-bold mb-4 text-gray-900 dark:text-white text-center"}," Research: Statistical Analysis of Rain and Location Impact on Water Quality ",-1)),t[43]||(t[43]=m("p",{class:"text-center text-gray-600 dark:text-gray-400 mb-8 max-w-prose mx-auto"}," A deep dive into the statistical methods and results showing how rainfall and location affect enterococcus bacteria levels (MPN) in NYC waterways. ",-1)),s.value?(o(),d("div",sa,"Loading statistical analysis...")):(o(),d("div",ra,[m("section",oa,[t[3]||(t[3]=m("h2",{class:"text-2xl font-bold mb-4 text-blue-900 dark:text-blue-200"},"📊 Key Findings",-1)),m("div",la,[m("div",na,[m("div",ia,p(i.value.toFixed(1))+"%",1),t[0]||(t[0]=m("div",{class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},"Variance explained by location",-1))]),m("div",da,[m("div",ca,p((100*((null==(a=n.value)?void 0:a.rSquared)??0)).toFixed(1))+"%",1),t[1]||(t[1]=m("div",{class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},"Variance explained by rainfall",-1))])]),m("p",ua,[t[2]||(t[2]=m("strong",null,"Conclusion:",-1)),y(" Where you swim matters approximately "+p((i.value/(100*((null==(l=n.value)?void 0:l.rSquared)??.01))).toFixed(1))+"× more than recent rainfall in determining water quality. Both factors are statistically significant, but location is the dominant predictor. ",1)])]),m("section",null,[t[18]||(t[18]=m("h2",{class:"text-2xl font-bold mb-4 text-gray-900 dark:text-white"},"🔬 Statistical Methods",-1)),m("div",pa,[m("div",ga,[t[8]||(t[8]=m("h3",{class:"text-xl font-semibold mb-3 text-gray-900 dark:text-white"}," 1. Pearson Correlation Analysis (Rainfall vs. MPN) ",-1)),t[9]||(t[9]=m("p",{class:"text-sm text-gray-700 dark:text-gray-300 mb-3"}," We calculated the Pearson correlation coefficient (r) to measure the linear relationship between rainfall in the 1-2 days prior to sampling and MPN levels for all individual samples. Each sample is paired with the rainfall amount from its sampling week. ",-1)),t[10]||(t[10]=m("div",{class:"bg-white dark:bg-gray-900 rounded p-4 font-mono text-sm mb-3 overflow-x-auto border border-gray-300 dark:border-gray-600"},[m("div",null,"r = Σ[(x - x̄)(y - ȳ)] / √[Σ(x - x̄)² × Σ(y - ȳ)²]"),m("div",{class:"mt-2 text-xs text-gray-600 dark:text-gray-400"}," where x = rainfall (inches), y = MPN for each sample, x̄ = mean rainfall, ȳ = mean MPN ")],-1)),m("div",ma,[m("div",fa,[t[4]||(t[4]=m("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Correlation (r)",-1)),m("div",ya,p(null==(v=n.value)?void 0:v.r.toFixed(3)),1)]),m("div",va,[t[5]||(t[5]=m("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"R² (variance explained)",-1)),m("div",ha,p(null==(h=n.value)?void 0:h.rSquared.toFixed(3)),1)]),m("div",xa,[t[6]||(t[6]=m("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Sample size",-1)),m("div",ba,p(g.value)+" samples",1)])]),m("p",ka,[t[7]||(t[7]=m("strong",null,"Interpretation:",-1)),y(" The positive correlation (r = "+p(null==(N=n.value)?void 0:N.r.toFixed(3))+") indicates that higher rainfall is associated with higher MPN levels. However, rainfall only explains "+p((100*((null==(S=n.value)?void 0:S.rSquared)??0)).toFixed(1))+"% of the variance in water quality, meaning other factors (primarily location) account for most of the variation. ",1)])]),m("div",wa,[t[15]||(t[15]=m("h3",{class:"text-xl font-semibold mb-3 text-gray-900 dark:text-white"}," 2. Analysis of Variance (ANOVA) by Location ",-1)),t[16]||(t[16]=m("p",{class:"text-sm text-gray-700 dark:text-gray-300 mb-3"}," We used ANOVA to determine how much of the total variance in MPN levels can be attributed to differences between sampling locations versus within-location variation. The eta-squared (η²) statistic quantifies the proportion of variance explained. ",-1)),t[17]||(t[17]=m("div",{class:"bg-white dark:bg-gray-900 rounded p-4 font-mono text-sm mb-3 overflow-x-auto border border-gray-300 dark:border-gray-600"},[m("div",null,"η² = SS_between / SS_total"),m("div",{class:"mt-2 text-xs text-gray-600 dark:text-gray-400"},[y(" SS_between = Σ n_i(μ_i - μ)² (variance between locations)"),m("br"),y(" SS_total = Σ(x - μ)² (total variance) ")])],-1)),m("div",Ma,[m("div",Da,[t[11]||(t[11]=m("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"η² (variance explained)",-1)),m("div",Na,p((i.value/100).toFixed(3)),1)]),m("div",Pa,[t[12]||(t[12]=m("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Number of locations",-1)),m("div",Sa,p(c.value.length),1)]),m("div",Ca,[t[13]||(t[13]=m("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"Total samples",-1)),m("div",_a,p(g.value),1)])]),m("p",$a,[t[14]||(t[14]=m("strong",null,"Interpretation:",-1)),y(" Location explains "+p(i.value.toFixed(1))+"% of the variance in MPN levels. This is a large effect size, indicating that the choice of swimming location is the primary determinant of water quality exposure. The remaining variance comes from temporal factors (including rainfall), measurement error, and other unmeasured variables. ",1)])])])]),m("section",null,[t[22]||(t[22]=m("h2",{class:"text-2xl font-bold mb-4 text-gray-900 dark:text-white"},"📈 Rainfall vs. Water Quality",-1)),m("div",Aa,[t[20]||(t[20]=m("p",{class:"text-sm text-gray-700 dark:text-gray-300 mb-4"}," This scatter shows the relationship between 1-2 day rainfall and citywide average MPN. Each point represents one sampling week. ",-1)),m("div",ja,[m("table",La,[t[19]||(t[19]=m("thead",null,[m("tr",{class:"border-b border-gray-300 dark:border-gray-600"},[m("th",{class:"text-left py-2 px-2"},"Date"),m("th",{class:"text-right py-2 px-2"},"Rainfall (in)"),m("th",{class:"text-right py-2 px-2"},"Avg MPN"),m("th",{class:"text-left py-2 px-4"},"Visual")])],-1)),m("tbody",null,[(o(!0),d(x,null,b(w.value,e=>(o(),d("tr",{key:e.date,class:"border-b border-gray-200 dark:border-gray-700"},[m("td",Oa,p(e.date),1),m("td",Ta,p(e.x.toFixed(2)),1),m("td",Ea,p(Math.round(e.y)),1),m("td",Ba,[m("div",Ra,[m("div",{class:"h-3 bg-blue-500 dark:bg-blue-400 rounded",style:k({width:`${Math.min(50*e.x,100)}px`}),title:`Rainfall: ${e.x.toFixed(2)} in`},null,12,Va),m("div",{class:"h-3 rounded ml-2",style:k({width:`${Math.min(e.y/3,100)}px`,backgroundColor:e.y<35?"#22c55e":e.y<=104?"#facc15":"#ef4444"}),title:`MPN: ${Math.round(e.y)}`},null,12,qa)])])]))),128))])])]),t[21]||(t[21]=P('<p class="text-xs text-gray-600 dark:text-gray-400 mt-3"><span class="inline-block w-3 h-3 bg-blue-500 rounded mr-1"></span> Blue = Rainfall <span class="inline-block w-3 h-3 bg-green-500 rounded mr-1 ml-3"></span> Green = Safe MPN <span class="inline-block w-3 h-3 bg-yellow-400 rounded mr-1 ml-2"></span> Yellow = Caution <span class="inline-block w-3 h-3 bg-red-500 rounded mr-1 ml-2"></span> Red = Unsafe </p>',1))])]),m("section",null,[t[27]||(t[27]=m("h2",{class:"text-2xl font-bold mb-4 text-gray-900 dark:text-white"},"📍 Location-Level Analysis",-1)),m("div",Fa,[m("div",Ia,[t[23]||(t[23]=m("h3",{class:"text-lg font-semibold mb-3 text-gray-900 dark:text-white"},"Most Variable Locations",-1)),t[24]||(t[24]=m("p",{class:"text-xs text-gray-600 dark:text-gray-400 mb-3"}," Sites where water quality changes the most (high variance in MPN). These locations are more sensitive to environmental factors like rainfall. ",-1)),m("div",Wa,[(o(!0),d(x,null,b(M.value,(e,t)=>(o(),d("div",{key:e.siteName,class:"flex justify-between items-start"},[m("div",za,[m("span",Ua,p(t+1)+". "+p(e.siteName),1),m("div",Ha," Avg: "+p(Math.round(e.avgMpn))+" MPN | Variance: "+p(Math.round(e.variance))+" | n="+p(e.samples),1)])]))),128))])]),m("div",Qa,[t[25]||(t[25]=m("h3",{class:"text-lg font-semibold mb-3 text-gray-900 dark:text-white"},"Most Consistent Locations",-1)),t[26]||(t[26]=m("p",{class:"text-xs text-gray-600 dark:text-gray-400 mb-3"}," Sites with the least variation in water quality (low variance). These locations tend to be predictably safe or unsafe regardless of recent conditions. ",-1)),m("div",Ya,[(o(!0),d(x,null,b(D.value,(e,t)=>(o(),d("div",{key:e.siteName,class:"flex justify-between items-start"},[m("div",Ga,[m("span",Ka,p(t+1)+". "+p(e.siteName),1),m("div",Ja," Avg: "+p(Math.round(e.avgMpn))+" MPN | Variance: "+p(Math.round(e.variance))+" | n="+p(e.samples),1)])]))),128))])])])]),m("section",Za,[t[33]||(t[33]=m("h2",{class:"text-2xl font-bold mb-4 text-amber-900 dark:text-amber-200"},"💡 Practical Implications",-1)),m("div",Xa,[t[30]||(t[30]=m("div",{class:"flex gap-3"},[m("span",{class:"text-xl"},"1️⃣"),m("div",null,[m("strong",null,"Location is the primary factor:"),y(" Choose your swimming location carefully. Sites with consistently low MPN values (e.g., well-circulated areas of the Hudson River) are safer bets than chronically contaminated sites (e.g., Gowanus Canal, Newtown Creek). ")])],-1)),m("div",es,[t[29]||(t[29]=m("span",{class:"text-xl"},"2️⃣",-1)),m("div",null,[t[28]||(t[28]=m("strong",null,"Rainfall matters, but less:",-1)),y(" While recent rain does increase MPN levels (r = "+p(null==(C=n.value)?void 0:C.r.toFixed(2))+"), this effect is moderate. Avoiding swimming 1-2 days after heavy rain is wise, but location choice is more critical. ",1)])]),t[31]||(t[31]=m("div",{class:"flex gap-3"},[m("span",{class:"text-xl"},"3️⃣"),m("div",null,[m("strong",null,"Some locations are unpredictable:"),y(" High-variance sites may be safe on some days and unsafe on others. For these locations, checking recent conditions (rainfall, CSO discharge events) is especially important. ")])],-1)),t[32]||(t[32]=m("div",{class:"flex gap-3"},[m("span",{class:"text-xl"},"4️⃣"),m("div",null,[m("strong",null,"Consistent sites are reliable:"),y(" Low-variance locations that are consistently safe make the best swimming spots. These areas have good water circulation, minimal pollution sources, and stable water quality. ")])],-1))])]),m("section",ts,[t[41]||(t[41]=m("h2",{class:"text-2xl font-bold mb-4 text-gray-900 dark:text-white"},"📝 Methods & Data Notes",-1)),m("ul",as,[m("li",null,[t[34]||(t[34]=m("strong",null,"Data source:",-1)),y(" NYC Water Quality Monitoring Program, weekly sampling at "+p(c.value.length)+" sites across "+p(r.value.length)+" weeks",1)]),t[37]||(t[37]=m("li",null,[m("strong",null,"MPN measurement:"),y(" Most Probable Number of enterococcus bacteria per 100mL, measured using standard microbiological methods")],-1)),t[38]||(t[38]=m("li",null,[m("strong",null,"Rainfall data:"),y(" NOAA Central Park weather station, 1-2 day window chosen based on preliminary analysis showing strongest correlation")],-1)),m("li",null,[t[35]||(t[35]=m("strong",null,"Statistical approach:",-1)),y(" Both rainfall correlation and location variance are calculated using the same dataset of "+p(g.value)+" individual samples to ensure fair comparison. Each sample is paired with the rainfall from its sampling week.",1)]),t[39]||(t[39]=m("li",null,[m("strong",null,"Statistical software:"),y(" Calculations performed in JavaScript using standard statistical formulas (Pearson correlation and one-way ANOVA)")],-1)),t[40]||(t[40]=m("li",null,[m("strong",null,"Limitations:"),y(" Does not account for Combined Sewer Overflow (CSO) events, tidal effects, temperature, or other environmental variables that may influence water quality")],-1)),m("li",null,[t[36]||(t[36]=m("strong",null,"Effect size interpretation:",-1)),y(" Cohen's guidelines suggest η² > 0.14 is a large effect, indicating location's "+p(i.value.toFixed(1))+"% variance explained is substantial",1)])])])])),m("div",ss,[f(ct,{isDarkMode:u(W)},null,8,["isDarkMode"]),f(Tt,{isDarkMode:u(W)},null,8,["isDarkMode"]),f(it,{isDarkMode:u(W)},null,8,["isDarkMode"])])])])}}}),os=S({history:C(`${F}/`),routes:[{path:"/",component:ce},{path:"/index",component:bt},{path:"/map",redirect:`/${I}`},{path:"/:date",component:_t},{path:"/trends",component:ea},{path:"/research",component:rs}]});os.afterEach(()=>{q("$pageview")});const ls=_(O);ls.use(os),ls.mount("#app"),setTimeout(()=>{const e=`${F}/data/${I}/enriched.geojson`,t=`${F}/data/${I}/metadata.json`;Promise.all([fetch(e).then(e=>e.ok?e.json():null),fetch(t).then(e=>e.ok?e.json():null)]).then(([e,t])=>{if(e&&t)try{sessionStorage.setItem(`staticData-${I}`,JSON.stringify({geojson:e,metadata:t}))}catch(a){}}).catch(e=>{})},100),setTimeout(()=>{V()},1e3);
